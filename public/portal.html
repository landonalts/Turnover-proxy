<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Turnover Portal</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* { box-sizing: border-box; font-family: system-ui, sans-serif; }

body {
  margin: 0;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #eef2f7;
  transition: 0.3s;
}

body.dark { background: #020617; color: #e5e7eb; }
body.stealth h1, body.stealth p { display: none; }

.card {
  background: white;
  width: 100%;
  max-width: 460px;
  padding: 26px;
  border-radius: 14px;
  box-shadow: 0 15px 40px rgba(0,0,0,0.08);
}

body.dark .card { background: #020617; }

.row { display: flex; gap: 10px; margin-bottom: 14px; }

input {
  flex: 1;
  padding: 12px;
  border-radius: 10px;
  border: 1px solid #cbd5f5;
}

button {
  padding: 12px 16px;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  background: #3b82f6;
  color: white;
}

.secondary {
  background: #e5e7eb;
  color: #111827;
}

body.dark .secondary {
  background: #1e293b;
  color: #e5e7eb;
}

.overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.45);
  display: none;
  align-items: center;
  justify-content: center;
}

.overlay.show { display: flex; }

.modal {
  background: white;
  width: 90%;
  max-width: 380px;
  padding: 22px;
  border-radius: 14px;
}

body.dark .modal { background: #020617; }

.stat {
  font-size: 13px;
  margin: 6px 0;
  color: #6b7280;
}

body.dark .stat { color: #94a3b8; }

.disabled {
  opacity: .45;
  cursor: not-allowed;
}
</style>
</head>

<body>

<div class="card">
  <h1>Turnover</h1>
  <p>Enter a website to open via proxy</p>

  <div class="row">
    <input id="url" placeholder="example.com">
    <button onclick="openSite()">Open</button>
  </div>

  <button class="secondary" onclick="openSettings()">Settings</button>
</div>

<!-- SETTINGS -->
<div class="overlay" id="settings">
  <div class="modal">
    <strong>Connection Info</strong>

    <div class="stat">IP: <span id="ip">Loading…</span></div>
    <div class="stat">Location: <span id="loc">Loading…</span></div>
    <div class="stat">Last Site: <span id="site">None</span></div>

    <hr>

    <strong>Appearance</strong>
    <button class="secondary" onclick="toggleTheme()">Light / Dark</button>
    <button class="secondary" onclick="toggleStealth()">Stealth Mode</button>

    <hr>

    <strong>Advanced (Backend Required)</strong>
    <button class="secondary disabled">Change IP</button>
    <button class="secondary disabled">Rotate IPs</button>
    <button class="secondary disabled">Bypass Verification</button>

    <p class="stat">
      These require self-hosted servers and cannot work in client-only code.
    </p>

    <button class="secondary" onclick="closeSettings()">Close</button>
  </div>
</div>

<script>
function openSite() {
  let url = document.getElementById("url").value.trim();
  if (!url) return;
  if (!url.startsWith("http")) url = "https://" + url;

  localStorage.setItem("lastSite", url);
  document.getElementById("site").textContent = url;

  window.open("/api/proxy?url=" + encodeURIComponent(url), "_blank");
}

function openSettings() {
  document.getElementById("settings").classList.add("show");
}

function closeSettings() {
  document.getElementById("settings").classList.remove("show");
}

function toggleTheme() {
  document.body.classList.toggle("dark");
  localStorage.setItem("theme",
    document.body.classList.contains("dark") ? "dark" : "light");
}

function toggleStealth() {
  document.body.classList.toggle("stealth");
}

if (localStorage.getItem("theme") === "dark")
  document.body.classList.add("dark");

if (localStorage.getItem("lastSite"))
  document.getElementById("site").textContent =
    localStorage.getItem("lastSite");

/* REAL IP + LOCATION */
fetch("https://ipapi.co/json/")
  .then(r => r.json())
  .then(d => {
    document.getElementById("ip").textContent = d.ip;
    document.getElementById("loc").textContent =
      `${d.city}, ${d.region}, ${d.country_name}`;
  })
  .catch(() => {
    document.getElementById("ip").textContent = "Unavailable";
    document.getElementById("loc").textContent = "Unavailable";
  });
</script>

</body>
</html>
